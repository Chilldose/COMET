

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="Python 2.7" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="Python 2.7" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>utilities &mdash; UniDAQ beta documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> UniDAQ
          

          
          </a>

          
            
            
              <div class="version">
                0.9.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../programstructure.html">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datastructure.html">Data Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataexchange.html">Data Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../measurementjobgen.html">Measurement Job Generation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code.html">API references</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">UniDAQ</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>utilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for utilities</h1><div class="highlight"><pre>
<span></span><span class="c1">#This class provides usefull functions for gernerall purposes</span>
<span class="c1">#Class functions:</span>
<span class="c1">#create_new_file,</span>

<span class="c1">#IO-functions</span>
<span class="c1"># open_file,</span>
<span class="c1"># close_file,</span>
<span class="c1"># flush_to_file,</span>
<span class="c1"># close_file,</span>
<span class="c1"># read_from_file,</span>
<span class="c1"># write_to_file,</span>
<span class="c1">#</span>
<span class="c1">#Ramping</span>
<span class="c1"># ramp_voltage</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os.path</span><span class="o">,</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">logging</span><span class="o">,</span> <span class="nn">yaml</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="k">import</span> <span class="n">QtCore</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="k">import</span> <span class="n">solve</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">det</span><span class="p">,</span> <span class="n">qr</span><span class="p">,</span> <span class="n">inv</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">pyqtgraph</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">import</span> <span class="nn">VisaConnectWizard</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="k">import</span> <span class="n">QApplication</span>
<span class="c1">#from __future__ import print_function # Needed for the rtd functions that its written in 3</span>

<span class="n">l</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

<div class="viewcode-block" id="help_functions"><a class="viewcode-back" href="../code.html#utilities.help_functions">[docs]</a><span class="k">class</span> <span class="nc">help_functions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Helpfull function is a multipurpose class with a variety of function and tasks.</span>
<span class="sd">    It contains functions regarding error handling an file generation as well as generating ramps (e.g. for bias ramps)</span>
<span class="sd">    For more information see he docs for the functions itself&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">):</span>
        <span class="k">pass</span>


<div class="viewcode-block" id="help_functions.write_init_file"><a class="viewcode-back" href="../code.html#utilities.help_functions.write_init_file">[docs]</a>    <span class="k">def</span> <span class="nf">write_init_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function writes init files for devices and default files</span>

<span class="sd">        :param name: Name of the file to be written to</span>
<span class="sd">        :param data: Data in Dict format</span>
<span class="sd">        :param path: Path where to write</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># find the resource and exclude it from the file</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1">#Removes the Visa resource if needed</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Visa_Resource&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.yaml&quot;</span><span class="p">)):</span>

            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.yaml&quot;</span><span class="p">))</span>
            <span class="c1">#directory = path[:len(path)-len(path.split(&quot;/&quot;)[-1])]</span>
            <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_new_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">path</span><span class="p">,</span> <span class="n">os_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span>

            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">close_file</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.yaml&quot;</span><span class="p">)):</span>

            <span class="c1">#directory = path[:len(path) - len(path.split(&quot;/&quot;)[-1])]</span>

            <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_new_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">path</span><span class="p">,</span> <span class="n">os_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span>

            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">close_file</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>


            <span class="c1"># Debricated</span>
            <span class="c1">#for items in data.items():</span>
            <span class="c1">#    if type(items[1]) != type([]):</span>
            <span class="c1">#        string = str(items[0]) + &quot; = \&quot;&quot; + str(items[1]) + &quot;\&quot;\n&quot;</span>
            <span class="c1">#        os.write(file, str(string))</span>
            <span class="c1">#    else:</span>
            <span class="c1">#        string = str(items[0]) + &quot; = \&quot;&quot;</span>
            <span class="c1">#        for i in items[1]:</span>
            <span class="c1">#            string += str(i).strip(&quot;&#39;&quot;).strip(&quot;[&quot;).strip(&quot;]&quot;) + &quot;,&quot;</span>
            <span class="c1">#        string = string[:-1]</span>
            <span class="c1">#        string += &quot;\&quot;\n&quot;</span>
            <span class="c1">#        print string</span>
            <span class="c1">#        os.write(file, string)</span>



        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>

    <span class="c1"># This function works as a decorator to measure the time of function to execute</span>
<div class="viewcode-block" id="help_functions.timeit"><a class="viewcode-back" href="../code.html#utilities.help_functions.timeit">[docs]</a>    <span class="k">def</span> <span class="nf">timeit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Intended to be used as decorator for functions. It returns the time needed for the function to run</span>

<span class="sd">        :param method: method to be timed</span>
<span class="sd">        :return: time needed by method</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">timed</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
            <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="n">exce_time</span> <span class="o">=</span> <span class="n">end_time</span><span class="o">-</span><span class="n">start_time</span>

            <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">exce_time</span>

        <span class="k">return</span> <span class="n">timed</span> <span class="c1"># here the memberfunction timed will be called</span></div>

    <span class="c1"># These functions are for reading and writing to files------------------------------------</span>
    <span class="c1">#-----------------------------------------------------------------------------------------</span>

    <span class="c1"># This function works as a decorator to raise errors if python interpretor does not do that automatically</span>
<div class="viewcode-block" id="help_functions.raise_exception"><a class="viewcode-back" href="../code.html#utilities.help_functions.raise_exception">[docs]</a>    <span class="k">def</span> <span class="nf">raise_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Intended to be used as decorator for pyQt functions in the case that errors are not correctly passed to the python interpret</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">raise_ex</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1">#Try running the method</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
            <span class="c1"># raise the exception and print the stack trace</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some error occured in the function &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;. With Error:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>  <span class="c1"># this is optional but sometime the raise does not work</span>
                <span class="k">raise</span>  <span class="c1"># this raises the error with stack backtrack</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="n">raise_ex</span><span class="c1"># here the memberfunction timed will be called</span></div>

        <span class="c1"># This function works as a decorator to raise errors if python interpretor does not do that automatically</span>

<div class="viewcode-block" id="help_functions.run_with_lock"><a class="viewcode-back" href="../code.html#utilities.help_functions.run_with_lock">[docs]</a>    <span class="k">def</span> <span class="nf">run_with_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Intended to be used as decorator for functions which need to be threadsave. Warning: all functions acquire the same lock, be carefull.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">with_lock</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Try running the method</span>
                <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
                    <span class="n">l</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Lock acquired by program: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
                <span class="n">l</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Lock released by program: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
            <span class="c1"># raise the exception and print the stack trace</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A lock could not be acquired in &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;. With Error:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">error</span><span class="p">))</span> <span class="c1"># this is optional but sometime the raise does not work</span>
                <span class="k">raise</span>  <span class="c1"># this raises the error with stack backtrace</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="n">with_lock</span>  <span class="c1"># here the memberfunction timed will be called</span></div>

    <span class="c1"># Creates a new file</span>
<div class="viewcode-block" id="help_functions.create_new_file"><a class="viewcode-back" href="../code.html#utilities.help_functions.create_new_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_new_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;default.txt&quot;</span><span class="p">,</span> <span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;default_path&quot;</span><span class="p">,</span> <span class="n">os_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;.txt&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simply creates a file</span>

<span class="sd">        :param filename:</span>
<span class="sd">        :param filepath:</span>
<span class="sd">        :param os_file:</span>
<span class="sd">        :param suffix:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">filepath</span> <span class="o">==</span> <span class="s2">&quot;default_path&quot;</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">filepath</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span>

        <span class="n">filename</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span>

        <span class="c1">#First check if Filename already exists, when so, add a counter to the file.</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="o">+</span><span class="n">filename</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning filename &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; already exists!&quot;</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Warning filename &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; already exists!&quot;</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span> <span class="c1"># Adds sufix to filename</span>
            <span class="k">while</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="o">+</span><span class="n">filename</span><span class="p">)):</span>  <span class="c1"># checks if file exists</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>  <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>  <span class="c1"># if exists than change the last number in filename string</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Filename changed to &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Filename changed to &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os_file</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="o">+</span><span class="n">filename</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">O_WRONLY</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_CREAT</span><span class="p">)</span> <span class="c1"># Creates the file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="o">+</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

        <span class="n">l</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated file: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generated file: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">fd</span></div>

    <span class="c1"># Opens a file for reading and writing</span>
<div class="viewcode-block" id="help_functions.open_file"><a class="viewcode-back" href="../code.html#utilities.help_functions.open_file">[docs]</a>    <span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;default.txt&quot;</span><span class="p">,</span> <span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;default_path&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Just opens a file and returns the file pointer</span>

<span class="sd">        :return: File</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">filepath</span> <span class="o">==</span> <span class="s2">&quot;default_path&quot;</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span> <span class="c1">#Opens file for reading and writing</span>
            <span class="k">return</span> <span class="n">fd</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not an existing file.&quot;</span><span class="p">)</span></div>

    <span class="c1"># Closes a file (just needs the file pointer)</span>
<div class="viewcode-block" id="help_functions.close_file"><a class="viewcode-back" href="../code.html#utilities.help_functions.close_file">[docs]</a>    <span class="k">def</span> <span class="nf">close_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closed the file specified in param file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">GeneratorExit</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closing the file: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not possible&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unknown error occured, while closing file &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span></div>

    <span class="c1"># This flushes a string to a file</span>
<div class="viewcode-block" id="help_functions.flush_to_file"><a class="viewcode-back" href="../code.html#utilities.help_functions.flush_to_file">[docs]</a>    <span class="k">def</span> <span class="nf">flush_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flushes data to a opend file</span>
<span class="sd">        Only strings or numbers allowed, Lists will work too but may cause data scrambling</span>
<span class="sd">        Only use this with created files from function &#39;create_new_file&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">))</span> <span class="c1">#Writes the message to file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">fsync</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="c1"># ensures that the data is written on HDD</span></div>

<div class="viewcode-block" id="help_functions.write_to_file"><a class="viewcode-back" href="../code.html#utilities.help_functions.write_to_file">[docs]</a>    <span class="k">def</span> <span class="nf">write_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;default.txt&quot;</span><span class="p">,</span> <span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;default_path&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This writes content to a file. Be aware, input must be of type &#39;list&#39; each entry containing the information of one line</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Writing to file &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot; was not possible&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unknown error occured, while writing to file &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">close_file</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></div>

<div class="viewcode-block" id="help_functions.read_from_file"><a class="viewcode-back" href="../code.html#utilities.help_functions.read_from_file">[docs]</a>    <span class="k">def</span> <span class="nf">read_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;default.txt&quot;</span><span class="p">,</span> <span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;default_path&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gives you the content of the file in an list, each list entry is one line of the file (datatype=string)</span>
<span class="sd">        Warning: File gets closed after reading</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not read from file.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unknown error occured, while reading from file &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">close_file</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></div>

    <span class="c1"># These functions are for reading and writing to files------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------------------end</span>

<div class="viewcode-block" id="help_functions.ramp_voltage_job"><a class="viewcode-back" href="../code.html#utilities.help_functions.ramp_voltage_job">[docs]</a>    <span class="k">def</span> <span class="nf">ramp_voltage_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queue</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">voltage_Start</span><span class="p">,</span> <span class="n">voltage_End</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">wait_time</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">complience</span><span class="o">=</span><span class="mi">100</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Only use this function for simple ramping for the main, never inside a measurement!!!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Measurement&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;ramp_voltage&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Resource&quot;</span><span class="p">:</span> <span class="n">resource</span><span class="p">,</span>
                                <span class="s2">&quot;Order&quot;</span><span class="p">:</span> <span class="n">order</span><span class="p">,</span>
                                <span class="s2">&quot;StartVolt&quot;</span><span class="p">:</span> <span class="n">voltage_Start</span><span class="p">,</span>
                                <span class="s2">&quot;EndVolt&quot;</span><span class="p">:</span> <span class="n">voltage_End</span><span class="p">,</span>
                                <span class="s2">&quot;Steps&quot;</span><span class="p">:</span> <span class="n">step</span><span class="p">,</span>
                                <span class="s2">&quot;Wait&quot;</span><span class="p">:</span> <span class="n">wait_time</span><span class="p">,</span>
                                <span class="s2">&quot;Complience&quot;</span><span class="p">:</span> <span class="n">complience</span><span class="p">}}}</span>
        <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">job</span><span class="p">)</span></div>

<div class="viewcode-block" id="help_functions.int2dt"><a class="viewcode-back" href="../code.html#utilities.help_functions.int2dt">[docs]</a>    <span class="k">def</span> <span class="nf">int2dt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">ts_mult</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert seconds value into datatime struct which can be used for x-axis labeeling</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_mult</span><span class="p">)</span></div>

<div class="viewcode-block" id="help_functions.get_timestring_from_int"><a class="viewcode-back" href="../code.html#utilities.help_functions.get_timestring_from_int">[docs]</a>    <span class="k">def</span> <span class="nf">get_timestring_from_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_array</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts int time to timestring</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">time_array</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">int2dt</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="nb">format</span><span class="p">)))</span>
        <span class="k">return</span> <span class="nb">list</span></div>

<div class="viewcode-block" id="help_functions.get_thicks_for_timestamp_plot"><a class="viewcode-back" href="../code.html#utilities.help_functions.get_thicks_for_timestamp_plot">[docs]</a>    <span class="k">def</span> <span class="nf">get_thicks_for_timestamp_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_array</span><span class="p">,</span> <span class="n">max_number_of_thicks</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This gives back a list of tuples for the thicks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">final_thicks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_array</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_number_of_thicks</span><span class="p">:</span>
            <span class="n">final_thicks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_timestring_from_int</span><span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_array</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="o">/</span><span class="n">max_number_of_thicks</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
                <span class="n">final_thicks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">time_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">int2dt</span><span class="p">(</span><span class="n">time_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="nb">format</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">final_thicks</span></div>

<div class="viewcode-block" id="help_functions.CAxisTime"><a class="viewcode-back" href="../code.html#utilities.help_functions.CAxisTime">[docs]</a>    <span class="k">class</span> <span class="nc">CAxisTime</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">AxisItem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Over riding the tickString method by extending the class&quot;&quot;&quot;</span>

            <span class="c1"># @param[in] values List of time.</span>
            <span class="c1"># @param[in] scale Not used.</span>
            <span class="c1"># @param[in] spacing Not used.</span>
<div class="viewcode-block" id="help_functions.CAxisTime.tickStrings"><a class="viewcode-back" href="../code.html#utilities.help_functions.CAxisTime.tickStrings">[docs]</a>        <span class="k">def</span> <span class="nf">tickStrings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">spacing</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Generate the string labeling of X-axis from the seconds value of Y-axis&quot;&quot;&quot;</span>
            <span class="c1"># sending a list of values in format &quot;HH:MM:SS.SS&quot; generated from Total seconds.</span>
            <span class="k">return</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">int2dt</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">))[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span></div>

<div class="viewcode-block" id="help_functions.CAxisTime.int2dt"><a class="viewcode-back" href="../code.html#utilities.help_functions.CAxisTime.int2dt">[docs]</a>        <span class="k">def</span> <span class="nf">int2dt</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ts_mult</span><span class="o">=</span><span class="mi">1</span><span class="n">e3</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Convert seconds value into datatime struct which can be used for x-axis labeeling&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">/</span> <span class="n">ts_mult</span><span class="p">))</span></div></div>

<div class="viewcode-block" id="help_functions.build_command"><a class="viewcode-back" href="../code.html#utilities.help_functions.build_command">[docs]</a>    <span class="k">def</span> <span class="nf">build_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_dict</span><span class="p">,</span> <span class="n">command_tuple</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function correctly builds the command structure for devices.</span>
<span class="sd">        You must pass the device object dictionary with all parameters and a command tuple, consisting of:</span>
<span class="sd">        Command: A command specified in the device object.</span>
<span class="sd">        Value: A string or a list of commands which are the value the command is send with. (Also possible &#39;[a,b,c]&#39; etc.)</span>

<span class="sd">        If a syntax key is present in the device object like: &#39;syntax&#39;: &#39;(@###)&#39; the char between the # will be pre and appended, to the values, respectively</span>
<span class="sd">        If a key has a corresponing CSV prepended, like get_position = pos and CSV_get_position = x,y,z, the value passed need</span>
<span class="sd">        to have at least as much values, or the missing values WILL be filled with 0. (the CSV is actually not needed, this is for security reasons, so you dont forget something)</span>
<span class="sd">        Furthermore, if a seperator key is present, you can specify how the CSV command is seperated, standard is a single space.</span>
<span class="sd">        If the key command_order is specified either with 1 or -1 the logical order of the command is reversed, so with -1</span>
<span class="sd">        the values are comming first then the actual command. When nothing is specified a 1 is assumed</span>

<span class="sd">        If you pass a list in values, all of these will be generate a return list with each list values a complete command, even when you have a different separator specified</span>
<span class="sd">        If you want a correct one specify a CSV command. Non list object will be ignored and alle appended to a long command</span>

<span class="sd">        If you just pass a string, not a tuple only the command will be returned</span>

<span class="sd">        If a terminator key is in the object, this will be automatically be appended</span>

<span class="sd">        If the key: no_syntax_with_single_commmand is prevalent, the command build (when only a string is passed)will only return the command without syntax (if specified)</span>

<span class="sd">        Return value is usually a string with the command. Except if your command consists of a list e.g you want:</span>
<span class="sd">        device_dict[command] =&gt; [&quot;comA&quot;, &quot;comB&quot;], then both commands will be build with the values and a list of both commands will be returned</span>


<span class="sd">        :param device: device dictionary</span>
<span class="sd">        :param command_tuple: (command, value), can also be a string for a final command</span>
<span class="sd">        :return string or list, depending if dict[command] is a list or a string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="c1"># The final command which should be send in the end</span>
        <span class="n">return_list</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Is list of commands which can be returned if need be</span>
        <span class="n">only_command</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Flag if only a command was passed, important if such a command doesnt need syntax!</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="n">unicode</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span><span class="o">==</span> <span class="nb">str</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span><span class="o">==</span> <span class="nb">float</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span><span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">command_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="c1"># so only tuple are now prevelent</span>
            <span class="n">only_command</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">command_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="c1"># so no unicode is present</span>

        <span class="c1"># Preparations</span>
        <span class="c1"># look for a syntax (paranteses and so on)</span>
        <span class="k">if</span> <span class="s2">&quot;syntax&quot;</span> <span class="ow">in</span> <span class="n">device_dict</span><span class="p">:</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">device_dict</span><span class="p">[</span><span class="s2">&quot;syntax&quot;</span><span class="p">])</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="n">syntax</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;###&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">syntax</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>  <span class="c1"># Most devices have no paranteses or whatsoever</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">syntax</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="c1"># Most devices have no paranteses or whatsoever</span>

        <span class="c1">#Looks if a separator is needed to sepatare mulitple orders</span>
        <span class="k">if</span> <span class="s2">&quot;separator&quot;</span> <span class="ow">in</span> <span class="n">device_dict</span><span class="p">:</span>
            <span class="n">sepa</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">device_dict</span><span class="p">[</span><span class="s2">&quot;separator&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sepa</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="c1"># This should be the standard for most devices</span>


        <span class="k">if</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">device_dict</span><span class="p">:</span>
            <span class="c1"># here all the magic happens</span>
            <span class="c1"># First look if the order is swichted or not (command value, or value command)</span>

            <span class="c1"># Check if multiple commands so list or so</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">device_dict</span><span class="p">[</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">==</span> <span class="nb">str</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">device_dict</span><span class="p">[</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">==</span> <span class="n">unicode</span><span class="p">:</span>
                <span class="n">command_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">device_dict</span><span class="p">[</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command_list</span> <span class="o">=</span> <span class="n">device_dict</span><span class="p">[</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

            <span class="k">for</span> <span class="n">command_item</span> <span class="ow">in</span> <span class="n">command_list</span><span class="p">:</span>
                <span class="n">command_item</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_item</span><span class="p">)</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

                <span class="c1"># Value -&gt; Command</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">device_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;command_order&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Now look if a csv structure is necessary for the command to work</span>
                    <span class="n">start_ind</span> <span class="o">=</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>  <span class="c1"># finds the index of the command, to search for</span>
                    <span class="k">if</span> <span class="s2">&quot;CSV&quot;</span> <span class="o">+</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">start_ind</span><span class="p">:]</span> <span class="ow">in</span> <span class="n">device_dict</span><span class="p">:</span>  <span class="c1"># looks if an actual csv-command is there</span>
                        <span class="c1"># Todo: test CSV command</span>
                        <span class="n">csv_commands</span> <span class="o">=</span> <span class="n">device_dict</span><span class="p">[</span><span class="s2">&quot;CSV&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="n">start_ind</span><span class="p">:]]</span>
                        <span class="n">csv_commands</span> <span class="o">=</span> <span class="n">csv_commands</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># get rid of some caracters which should not be there</span>
                        <span class="n">csv_commands</span> <span class="o">=</span> <span class="n">csv_commands</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="c1"># now split it for easy access</span>

                        <span class="c1"># Make sure you always got a list of the next commandblock will fail</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
                            <span class="n">value_list</span> <span class="o">=</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="n">unicode</span><span class="p">:</span>
                            <span class="n">value_list</span> <span class="o">=</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                            <span class="n">value_list</span> <span class="o">=</span> <span class="n">value_list</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

                        <span class="n">csv_list</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">value_list</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">csv_list</span> <span class="o">=</span> <span class="n">csv_list</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">com</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">csv_list</span><span class="p">):</span>
                            <span class="c1"># here the input will be checked if enough parameters are passed for this command.</span>
                            <span class="c1"># If not a 0 will be entered and a warning will be printed</span>
                            <span class="n">command</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="n">sepa</span>

                        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)):</span>  <span class="c1"># Fill the rest of the missing paramters</span>
                                <span class="nb">print</span> <span class="s2">&quot;Warning: Not enough parameters passed for function: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; the command must consist of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39; is missing! Inserted 0 instead.&quot;</span>
                                <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Warning: Not enough parameters passed for function: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; the command must consist of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39; is missing! Inserted 0 instead.&quot;</span><span class="p">)</span>
                                <span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">sepa</span>

                        <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="c1"># to get rid of last comma</span>

                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># So if no CSV was found for this command, just build the command with the value and the separator</span>
                        <span class="c1"># First check if a List is present or so</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
                            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                                <span class="n">command</span> <span class="o">=</span>  <span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">command_item</span>
                                <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                                <span class="c1"># Add a command terminator if one is needed and the last part of the syntax</span>
                                <span class="n">command</span> <span class="o">+=</span> <span class="n">device_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;execution_terminator&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                                <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">return_list</span>

                        <span class="k">else</span><span class="p">:</span> <span class="c1"># If only a command was passed</span>
                            <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">command</span> <span class="o">+=</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                            <span class="k">if</span> <span class="n">only_command</span> <span class="ow">and</span> <span class="n">device_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;no_syntax_with_single_commmand&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span> <span class="s2">&quot; &quot;</span> <span class="ow">and</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                                <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                                <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">syntax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

                    <span class="c1">#command += &quot; &quot; + str(device_dict[str(command_item)]).strip() + syntax[0]  # adds the order to the command</span>
                    <span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># adds the order to the command</span>
                    <span class="c1"># Add a command terminator if one is needed and the last part of the syntax</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">command</span> <span class="o">+=</span> <span class="n">device_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;execution_terminator&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="c1">#command += syntax[0]  # adds the order to the command</span>
                    <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

                <span class="c1">#Command -&gt; Value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">command</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># adds the order to the command</span>

                    <span class="c1"># Now look if a csv structure is necessary for the command to work</span>
                    <span class="n">start_ind</span> <span class="o">=</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="c1"># finds the index of the command, to search for</span>
                    <span class="k">if</span> <span class="s2">&quot;CSV&quot;</span> <span class="o">+</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">start_ind</span><span class="p">:]</span> <span class="ow">in</span> <span class="n">device_dict</span><span class="p">:</span> <span class="c1"># looks if an actual csv-command is there</span>
                        <span class="c1">#Todo: test CSV command</span>
                        <span class="n">csv_commands</span> <span class="o">=</span> <span class="n">device_dict</span><span class="p">[</span><span class="s2">&quot;CSV&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="n">start_ind</span><span class="p">:]]</span>
                        <span class="n">csv_commands</span> <span class="o">=</span> <span class="n">csv_commands</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="c1"># get rid of some caracters which should not be there</span>
                        <span class="n">csv_commands</span> <span class="o">=</span> <span class="n">csv_commands</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="c1"># now split it for easy access</span>

                        <span class="c1"># Make sure you always got a list of the next commandblock will fail</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
                            <span class="n">value_list</span> <span class="o">=</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">==</span><span class="nb">str</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span><span class="o">==</span><span class="n">unicode</span><span class="p">:</span>
                            <span class="n">value_list</span> <span class="o">=</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                            <span class="n">value_list</span> <span class="o">=</span> <span class="n">value_list</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>


                        <span class="n">csv_list</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">value_list</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">csv_list</span> <span class="o">=</span> <span class="n">csv_list</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">com</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">csv_list</span><span class="p">):</span>
                            <span class="c1"># here the input will be checked if enough parameters are passed for this command.</span>
                            <span class="c1"># If not a 0 will be entered and a warning will be printed</span>
                            <span class="n">command</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="n">sepa</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>

                        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)):</span><span class="c1"># Fill the rest of the missing paramters</span>
                                <span class="nb">print</span> <span class="s2">&quot;Warning: Not enough parameters passed for function: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; the command must consist of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39; is missing! Inserted 0 instead.&quot;</span>
                                <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Warning: Not enough parameters passed for function: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; the command must consist of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">csv_commands</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;&#39; is missing! Inserted 0 instead.&quot;</span><span class="p">)</span>
                                <span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">sepa</span>

                        <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="c1"># to get rid of last comma and space at the end if csv</span>
                        <span class="n">command</span> <span class="o">+=</span>  <span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                    <span class="k">else</span><span class="p">:</span> <span class="c1"># So if no CSV was found for this command, just build the command with the value and the separator</span>
                        <span class="c1"># First check if a List is present or so</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
                            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                                <span class="n">command</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">command_item</span> <span class="o">+</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                                <span class="c1"># Add a command terminator if one is needed and the last part of the syntax</span>
                                <span class="n">command</span> <span class="o">+=</span> <span class="n">device_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;execution_terminator&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                                <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">return_list</span>

                        <span class="k">else</span><span class="p">:</span> <span class="c1"># If its just one value or no value</span>
                            <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">command</span> <span class="o">+=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                            <span class="k">if</span> <span class="n">only_command</span> <span class="ow">and</span> <span class="n">device_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;no_syntax_with_single_commmand&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span> <span class="s2">&quot; &quot;</span> <span class="ow">and</span> <span class="n">syntax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                                <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">syntax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                                <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">syntax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

                            <span class="c1"># Add a command terminator if one is needed and the last part of the syntax</span>
                            <span class="n">command</span> <span class="o">+=</span> <span class="n">device_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;execution_terminator&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the command is not found in the device only command tuple will be send</span>
            <span class="nb">print</span> <span class="s2">&quot;Command &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; was not found in device! Unpredictable behavior may happen. No commad build!&quot;</span>
            <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Command &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; was not found in device! Unpredictable behavior may happen. No commad build!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># Add a command terminator if one is needed and the last part of the syntax</span>
        <span class="c1">#command += device_dict.get(&quot;execution_terminator&quot;,&quot;&quot;)</span>



        <span class="c1"># Todo: multiple commands return</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">return_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">return_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div></div>

<span class="n">hf</span> <span class="o">=</span> <span class="n">help_functions</span><span class="p">()</span>

<div class="viewcode-block" id="newThread"><a class="viewcode-back" href="../code.html#utilities.newThread">[docs]</a><span class="k">class</span> <span class="nc">newThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>  <span class="c1"># This class inherite the functions of the threading class</span>
    <span class="sd">&#39;&#39;&#39;Creates new threads easy, it needs the thread ID a name, the function/class,</span>
<span class="sd">    which should run in a seperated thread and the arguments passed to the object&#39;&#39;&#39;</span>

<div class="viewcode-block" id="newThread.__init__"><a class="viewcode-back" href="../code.html#utilities.newThread.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">object__</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>  <span class="c1"># Init where the threadID and Thread Name are defined</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param threadID: ID the thread should have</span>
<span class="sd">        :param name: Give the thread a name you want</span>
<span class="sd">        :param object__: The object which should run in the new thread</span>
<span class="sd">        :param args: Arguments passed to object__</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Opens the threading class</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object__</span><span class="o">=</span> <span class="n">object__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span></div>

    <span class="k">def</span> <span class="nf">run_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object__</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span> <span class="c1"># Just for clarification, not necessary.</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">object__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="newThread.run"><a class="viewcode-back" href="../code.html#utilities.newThread.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts running the thread&quot;&quot;&quot;</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Starting thread: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="c1"># run() is a member function of Thread() class. This will be called, when object thread will be started via thread.start()</span>
        <span class="n">l</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting thread: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="newThread.get"><a class="viewcode-back" href="../code.html#utilities.newThread.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;returns the Object&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object__</span></div></div>

<span class="k">class</span> <span class="nc">newThread_</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QThread</span><span class="p">):</span>  <span class="c1"># This class inherite the functions of the threading class</span>
    <span class="sd">&#39;&#39;&#39;Creates new threads easy, it needs the thread ID, a name, the function/class, which should run in a seperated thread</span>
<span class="sd">    This is the same thing like newThread but instead QTCore modules are used.&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">object__</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>  <span class="c1"># Init where the threadID and Thread Name are defined</span>

        <span class="n">QtCore</span><span class="o">.</span><span class="n">QThread</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Opens the threading class</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object__</span><span class="o">=</span> <span class="n">object__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">run_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object__</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span> <span class="c1"># Just for clarification, not necessary.</span>
        <span class="k">return</span> <span class="n">object__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Starting thread: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="c1"># run() is a member function of Thread() class. This will be called, when object thread will be started via thread.start()</span>
        <span class="n">l</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting thread: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">():</span>
        <span class="sd">&#39;&#39;&#39;returns the Object&#39;&#39;&#39;</span> <span class="c1"># Not working, do not use</span>
        <span class="n">newThread_</span><span class="o">.</span><span class="n">object__</span><span class="p">()</span>

<div class="viewcode-block" id="LogFile"><a class="viewcode-back" href="../code.html#utilities.LogFile">[docs]</a><span class="k">class</span> <span class="nc">LogFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class handles the Logfile for the whole framework</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logging_level</span> <span class="o">=</span> <span class="s2">&quot;debug&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the logfile with the logging level</span>
<span class="sd">        :param logging_level: None, debug, info, warning, error critical</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">LOG_FORMAT</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(asctime)s</span><span class="s2"> in function </span><span class="si">%(funcName)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">)[:</span><span class="mi">38</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/Logfiles/QTC_Logfile.log&quot;</span><span class="p">)</span> <span class="c1"># Filepath to Logfile directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">)[:</span><span class="mi">38</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/Logfiles&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span> <span class="o">=</span> <span class="n">logging_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_LEVELS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NOTSET&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s2">&quot;CRITICAL&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">welcome_string</span> <span class="o">=</span>  <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> \
                               <span class="s2">&quot;</span><span class="se">\t\t\t\t\t\t\t\t</span><span class="s2">  __         ______     ______     ______   __     __         ______           ______     ______   ______</span><span class="se">\n</span><span class="s2">  </span><span class="se">\</span>
<span class="s2">                               /\ \       /\  __ \   /\  ___\   /\  ___\ /\ \   /\ \       /\  ___\         /\  __ \   /\__  _\ /\  ___\ </span><span class="se">\n</span><span class="s2">   </span><span class="se">\</span>
<span class="s2">                              \ \ \____  \ \ \/\ \  \ \ \__ \  \ \  __\ \ \ \  \ \ \____  \ \  __\         \ \ \/\_\  \/_/\ \/ \ \ \____ </span><span class="se">\n</span><span class="s2">  </span><span class="se">\</span>
<span class="s2">                                \ \_____\  \ \_____\  \ \_____\  \ \_\    \ \_\  \ \_____\  \ \_____\        \ \___\_\    \ \_\  \ \_____\ </span><span class="se">\n</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                                  \/_____/   \/_____/   \/_____/   \/_/     \/_/   \/_____/   \/_____/         \/___/_/     \/_/   \/_____</span><span class="se">\n\n\n</span><span class="s2">&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_logging_level</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_PATH</span><span class="p">)</span> <span class="c1"># IS needed, because sometimes other modules like the visa modules would override the file and all logs are lost, so the log file is in appending mode and no data loss.</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Old Logfile could not be deleted: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="c1"># Check if the folder already exists or create the folder</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_directory</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_PATH</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LOG_FORMAT</span><span class="p">,</span> <span class="n">filemode</span><span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1"># Overrides the old file (this is just for initialization)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_directory</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_PATH</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LOG_FORMAT</span><span class="p">,</span> <span class="n">filemode</span><span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1"># Overrides the old file (this is just for initialization)</span>


        <span class="c1"># Create a logger Object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LOG</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>

        <span class="c1"># Print welcome message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LOG</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">welcome_string</span><span class="p">)</span>

    <span class="c1">#Simply changes the string input to a int for the logging level</span>
<div class="viewcode-block" id="LogFile.get_logging_level"><a class="viewcode-back" href="../code.html#utilities.LogFile.get_logging_level">[docs]</a>    <span class="k">def</span> <span class="nf">get_logging_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Checks the logging level input. If it is a string -&gt; convert. Otherwise, do nothing&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_LEVELS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div></div>

<div class="viewcode-block" id="Framework"><a class="viewcode-back" href="../code.html#utilities.Framework">[docs]</a><span class="k">class</span> <span class="nc">Framework</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generall class for handling all Framework related tasks, like updating the GUI etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values_from_GUI</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param values_from_GUI: A tuple of (list of functions, udate intervall)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_interval</span> <span class="o">=</span> <span class="n">values_from_GUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Framework.start_timer"><a class="viewcode-back" href="../code.html#utilities.Framework.start_timer">[docs]</a>    <span class="k">def</span> <span class="nf">start_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># Bug timer gets not called due to a lock somewhere else</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simply starts the timer</span>

<span class="sd">        :return: timer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Framework initialized&quot;</span><span class="p">)</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="p">()</span>
        <span class="n">timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_</span><span class="p">)</span>
        <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_interval</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">timer</span>

        <span class="k">return</span> <span class="n">timer</span></div>

<div class="viewcode-block" id="Framework.update_"><a class="viewcode-back" href="../code.html#utilities.Framework.update_">[docs]</a>    <span class="k">def</span> <span class="nf">update_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Periodically updates the functions in self.functions list</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#start = time.time()</span>
        <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">function</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not update framework &quot;</span> <span class="o">+</span> <span class="n">function</span><span class="p">)</span></div></div>
        <span class="c1">#end = time.time()</span>
        <span class="c1">#print end - start</span>

<span class="k">class</span> <span class="nc">transformation_old</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">vector_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">T</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;This function transform one vector into the basis of another&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">transformation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Calculates the transformation matrix of the system.</span>
<span class="sd">        Via the equation T = P^-1 Q where P and Q are comming from the linear system s*T + V0 = v</span>
<span class="sd">        a and must  be the linear hull (or simple three linear independent vecotrs)&#39;&#39;&#39;</span>

        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
                                  <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]]))</span>
                     <span class="c1">#[a[1][2]-a[0][2],a[2][2]-a[0][2]]]))</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="n">Pinvert</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

        <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
                                    <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>

                                    <span class="p">]))</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1">#T = solve(P, Q)</span>

        <span class="n">T</span> <span class="o">=</span> <span class="n">Pinvert</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

        <span class="c1">#print T.dot(np.transpose(a)[1])</span>

        <span class="c1">#V0 = np.transpose(b)[1] - np.dot(np.transpose(a)[1],T)</span>

        <span class="c1">#print V0</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">linear_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Calculates if the matrizes a and b are linear independet.</span>
<span class="sd">        a and b must be matrizes of type np.array([a1,a2,a3]), where ai are the corresponding linearhull.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Test linear dependency</span>
        <span class="n">detx</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">detx</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">qr_factorisation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Calculates the qr factorisation of a matrix (linear indenendecy is requiered)</span>
<span class="sd">        Basically it just calculates a Orthogonal matrix q and a upper triangula matrix r.</span>
<span class="sd">        A=Q*R is the basic principal behind it.&#39;&#39;&#39;</span>

        <span class="n">q</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">qr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">q</span>

    <span class="k">def</span> <span class="nf">renorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Renormalise the basis vektors of a matrix&#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">x</span>

<div class="viewcode-block" id="transformation"><a class="viewcode-back" href="../code.html#utilities.transformation">[docs]</a><span class="k">class</span> <span class="nc">transformation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class which handles afine transformations in 3 dimensions for handling sensor to jig coordinate systems&quot;&quot;&quot;</span>

    <span class="nd">@hf</span><span class="o">.</span><span class="n">raise_exception</span>
    <span class="k">def</span> <span class="nf">transformation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="p">,</span><span class="n">t3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the transformation matrix of the system.</span>
<span class="sd">        Via the equation T = P^-1 Q where P and Q are coming from the linear system s*T + V0 = v</span>
<span class="sd">        si are the corresponding vectors (coordinates) in the sensor system, ti are those from the table system.</span>
<span class="sd">        They must be numpy arrays.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>

        <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                    <span class="p">[</span><span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                    <span class="p">[</span><span class="n">t3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="p">])</span>

        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                    <span class="p">[</span><span class="n">s2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="p">[</span><span class="n">s3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="p">])</span>


        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Invert the P matrix</span>
            <span class="n">Pinv</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

            <span class="c1"># Build the dot product</span>
            <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Pinv</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

            <span class="c1"># Offset</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">s2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occured during the transformation with error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">return</span> <span class="n">T</span><span class="p">,</span> <span class="n">V0</span>

<div class="viewcode-block" id="transformation.vector_trans"><a class="viewcode-back" href="../code.html#utilities.transformation.vector_trans">[docs]</a>    <span class="k">def</span> <span class="nf">vector_trans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This function transforms a Vector from the sensor system to the table system by vs*T+V0=vt&quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T</span><span class="p">),</span><span class="n">V0</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="measurement_job_generation"><a class="viewcode-back" href="../code.html#utilities.measurement_job_generation">[docs]</a><span class="k">class</span> <span class="nc">measurement_job_generation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class handles all measurement generation items&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_variables</span><span class="p">,</span> <span class="n">queue_to_measurement_event_loop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param main_variables: Simply the state machine variables (&#39;defaults&#39;)</span>
<span class="sd">        :param queue_to_measurement_event_loop:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">main_variables</span><span class="p">[</span><span class="s2">&quot;Defaults&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue_to_measure</span> <span class="o">=</span> <span class="n">queue_to_measurement_event_loop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_job</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="measurement_job_generation.generate_job"><a class="viewcode-back" href="../code.html#utilities.measurement_job_generation.generate_job">[docs]</a>    <span class="k">def</span> <span class="nf">generate_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">additional_settings_dict</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function handles all the work need to be done in order to generate a job</span>
<span class="sd">        :param additional_settings_dict: If any additional settings are in place</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">final_job</span> <span class="o">=</span> <span class="n">additional_settings_dict</span>


        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;# Measurement file: </span><span class="se">\n</span><span class="s2"> &quot;</span> \
                      <span class="s2">&quot;# Project: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Current_project&quot;</span><span class="p">]</span>  <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span> \
                      <span class="s2">&quot;# Sensor Type: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Current_sensor&quot;</span><span class="p">]</span>  <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span> \
                      <span class="s2">&quot;# ID: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Current_filename&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span> \
                      <span class="s2">&quot;# Operator: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Current_operator&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span> \
                      <span class="s2">&quot;# Date: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>

        <span class="n">IVCV_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_IVCV</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="c1"># here additional header can be added</span>
        <span class="n">strip_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_strip</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">IVCV_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">final_job</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;IVCV&quot;</span><span class="p">:</span> <span class="n">IVCV_dict</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">strip_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">final_job</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;stripscan&quot;</span><span class="p">:</span> <span class="n">strip_dict</span><span class="p">})</span>

        <span class="c1"># Check if filepath is a valid path</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Current_filename&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Current_directory&quot;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">final_job</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;Header&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queue_to_measure</span><span class="o">.</span><span class="n">put</span><span class="p">({</span><span class="s2">&quot;Measurement&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_job</span><span class="p">})</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Sendet job: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">({</span><span class="s2">&quot;Measurement&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_job</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Please enter a valid path and name for the measurement file.&quot;</span><span class="p">)</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Please enter a valid path and name for the measurement file.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="measurement_job_generation.generate_IVCV"><a class="viewcode-back" href="../code.html#utilities.measurement_job_generation.generate_IVCV">[docs]</a>    <span class="k">def</span> <span class="nf">generate_IVCV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function generates all that has to do with IV or CV</span>
<span class="sd">        :param header: An additional header</span>
<span class="sd">        :return: the job dictionary</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">final_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">file_header</span> <span class="o">=</span> <span class="n">header</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;IV_measure&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">file_header</span> <span class="o">+=</span> <span class="s2">&quot;voltage[V]&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">+</span>  <span class="s2">&quot;current[A]&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;CV_measure&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">file_header</span> <span class="o">+=</span> <span class="s2">&quot;voltage[V]&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;capacitance[F]&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

        <span class="n">file_header</span> <span class="o">+=</span> <span class="s2">&quot;temperature[deg]&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;humidity[rel%]&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

        <span class="n">final_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="n">file_header</span><span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;IV_measure&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;IV_measure&quot;</span><span class="p">]</span>
            <span class="n">final_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;IV&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;StartVolt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;EndVolt&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Complience&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span> <span class="s2">&quot;e-6&quot;</span><span class="p">,</span> <span class="s2">&quot;Steps&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]}})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;CV_measure&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;CV_measure&quot;</span><span class="p">]</span>
            <span class="n">final_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;CV&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;StartVolt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;EndVolt&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Complience&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span> <span class="s2">&quot;e-6&quot;</span><span class="p">,</span> <span class="s2">&quot;Steps&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]}})</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">final_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span> <span class="c1"># If the dict consits only of one element (only the header)</span></div>

<div class="viewcode-block" id="measurement_job_generation.generate_strip"><a class="viewcode-back" href="../code.html#utilities.measurement_job_generation.generate_strip">[docs]</a>    <span class="k">def</span> <span class="nf">generate_strip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function generate all tha has to do with strip scans</span>
<span class="sd">        :param header: Additional header</span>
<span class="sd">        :return: strip job dictionary</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">final_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">all_measurements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Rint&quot;</span><span class="p">,</span> <span class="s2">&quot;Istrip&quot;</span><span class="p">,</span> <span class="s2">&quot;Idiel&quot;</span><span class="p">,</span> <span class="s2">&quot;Rpoly&quot;</span><span class="p">,</span><span class="s2">&quot;Cac&quot;</span><span class="p">,</span> <span class="s2">&quot;Cint&quot;</span><span class="p">,</span> <span class="s2">&quot;Idark&quot;</span><span class="p">,</span> <span class="s2">&quot;Cback&quot;</span><span class="p">,</span> <span class="s2">&quot;CintAC&quot;</span><span class="p">]</span> <span class="c1"># warning if this is not included here no job will generated. is intentional</span>

        <span class="k">def</span> <span class="nf">generate_dict</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39; Generates a simple dict for strip scan measurements&#39;&#39;&#39;</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="c1"># Checks if the checkbox is true or false, so if the measurement should be condcuted or not</span>
                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;measure_every&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;start_strip&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;end_strip&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{}</span>

        <span class="c1"># First check if strip scan should be done or not</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Stripscan_measure&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">final_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;StartVolt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;EndVolt&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Stripscan_measure&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Complience&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Stripscan_measure&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span> <span class="s2">&quot;e-6&quot;</span><span class="p">,</span> <span class="s2">&quot;Steps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Stripscan_measure&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]})</span>

            <span class="k">for</span> <span class="n">elemets</span> <span class="ow">in</span> <span class="n">all_measurements</span><span class="p">:</span>
                <span class="nb">dict</span> <span class="o">=</span> <span class="n">generate_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">elemets</span> <span class="o">+</span> <span class="s2">&quot;_measure&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">dict</span><span class="p">:</span>
                    <span class="n">final_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">elemets</span><span class="p">:</span> <span class="nb">dict</span><span class="p">})</span>

        <span class="n">final_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;Additional Header&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">})</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">final_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span> <span class="c1"># If the dict consits only of one element (only the header)</span></div></div>

<div class="viewcode-block" id="table_control_class"><a class="viewcode-back" href="../code.html#utilities.table_control_class">[docs]</a><span class="k">class</span> <span class="nc">table_control_class</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;This class handles all interactions with the table. Movement, status etc.</span>
<span class="sd">    This class is designed to be running in different instances.&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_variables</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="n">queue_to_GUI</span><span class="p">,</span> <span class="n">shell</span><span class="p">,</span> <span class="n">vcw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param main_variables: Defaults dict</span>
<span class="sd">        :param device: The VISA device object</span>
<span class="sd">        :param queue_to_GUI:</span>
<span class="sd">        :param shell: The UniDAQ shell object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">main_variables</span><span class="p">[</span><span class="s2">&quot;Defaults&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">devices</span> <span class="o">=</span> <span class="n">devices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">devices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Table_control&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_ready&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span> <span class="o">=</span> <span class="n">queue_to_GUI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span> <span class="o">=</span> <span class="n">vcw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shell</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">build_command</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Table_control&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">)[</span><span class="s2">&quot;Visa_Resource&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Warning table control could not be initialized!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">({</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;Table seems not to be connected!&quot;</span><span class="p">})</span>
            <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Table control could not be initialized!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zmove</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;height_movement&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="table_control_class.get_current_position"><a class="viewcode-back" href="../code.html#utilities.table_control_class.get_current_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Queries the current position of the table and writes it to the state machine&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span><span class="p">:</span>
            <span class="n">max_attempts</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">max_attempts</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># Loop as long as there is a valid position from the corvus</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Error&quot;</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="s2">&quot;get_position&quot;</span><span class="p">)</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="nb">list</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;x_pos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;y_pos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;z_pos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">return</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;The corvus has replied with a non valid position string: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
                    <span class="n">max_attempts</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="table_control_class.check_if_ready"><a class="viewcode-back" href="../code.html#utilities.table_control_class.check_if_ready">[docs]</a>    <span class="k">def</span> <span class="nf">check_if_ready</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maxcounter</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function checks if the movement of the table is done or not</span>
<span class="sd">        :param timeout: Timeout how long to wait between the attempts</span>
<span class="sd">        :param maxcounter: How often does the function try to get an answer, -1 infinite</span>
<span class="sd">        :return: 0 if ok error if not</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Alot of time can be wasted by the timeout of the visa read order</span>
        <span class="n">ready_command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="s2">&quot;all_done&quot;</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># counter how often the read attempt will be carried out</span>
        <span class="n">cal_not_done</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">ready_command</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">cal_not_done</span><span class="p">:</span>
            <span class="n">done</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">maxcounter</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="n">maxcounter</span><span class="p">:</span>
                    <span class="n">cal_not_done</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#exits the loop after some attempts</span>

            <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1.</span><span class="p">:</span> <span class="c1"># case when corvus is busy and does not respond to anything</span>
                <span class="k">pass</span>

            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span> <span class="c1"># motors are in movement</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">ready_command</span><span class="p">)</span> <span class="c1"># writes the command again</span>

            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="o">==</span> <span class="mf">2.</span><span class="p">:</span> <span class="c1"># joystick active</span>
                <span class="n">cal_not_done</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;Joystick of table control is active.&quot;</span><span class="p">}</span>

            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="o">==</span> <span class="mf">4.</span><span class="p">:</span> <span class="c1"># joystick active</span>
                <span class="n">cal_not_done</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;Table control is not switched on.&quot;</span><span class="p">}</span>

            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">4.</span><span class="p">:</span> <span class="c1"># joystick active</span>
                <span class="n">cal_not_done</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;The table control reported an unknown error, with errorcode: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">done</span><span class="p">)}</span>

            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span> <span class="c1"># when corvus is read again</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
                <span class="n">cal_not_done</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="mi">0</span>

            <span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span> <span class="c1"># Updates the GUI, maybe after some iterations</span>

            <span class="n">sleep</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span></div>

<div class="viewcode-block" id="table_control_class.initiate_table"><a class="viewcode-back" href="../code.html#utilities.table_control_class.initiate_table">[docs]</a>    <span class="k">def</span> <span class="nf">initiate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function triggers the table initiation</span>

<span class="sd">        :return: 0 if ok error if not</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_is_moving&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_is_moving&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;calibrate_motor&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
                <span class="n">errorcode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_if_ready</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">errorcode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">commands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">order</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;table_xmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;table_ymin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;table_zmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;table_xmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;table_ymax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;table_zmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">errorcode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_is_moving&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="table_control_class.check_position"><a class="viewcode-back" href="../code.html#utilities.table_control_class.check_position">[docs]</a>    <span class="k">def</span> <span class="nf">check_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desired_pos</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function checks if two positions are equal or not</span>

<span class="sd">        :param desired_pos: The position it should be</span>
<span class="sd">        :return: 0 if ok error if not</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">new_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_pos</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">desired_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span> <span class="c1"># up to a half micrometer</span>
                <span class="n">errorcode</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;MeasError&quot;</span><span class="p">:</span> <span class="s2">&quot;Table movement failed. Position: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_pos</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not equal to desired position: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">desired_pos</span><span class="p">)}</span>
                <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Table movement failed. Position: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_pos</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not equal to desired position: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">desired_pos</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">errorcode</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="k">def</span> <span class="nf">__already_there</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad_file</span><span class="p">,</span> <span class="n">strip</span><span class="p">,</span> <span class="n">transfomation_class</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Checks if we are already at the strip we want to move to</span>

<span class="sd">        :param pad_file:</span>
<span class="sd">        :param strip:</span>
<span class="sd">        :param transfomation_class:</span>
<span class="sd">        :param T:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :return: True if at strip</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>  <span class="c1"># table position</span>
        <span class="n">pad_pos</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pad_file</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="n">strip</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]]</span>  <span class="c1"># where it should be in sensor system</span>
        <span class="n">table_pos</span> <span class="o">=</span> <span class="n">transfomation_class</span><span class="o">.</span><span class="n">vector_trans</span><span class="p">(</span><span class="n">pad_pos</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V0</span><span class="p">)</span>  <span class="c1"># Transforms the vektor to the right basis</span>
        <span class="n">deltapos</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">table_pos</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="n">deltapos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>  <span class="c1"># Checks if the position is correct in a range of 0.5 um</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>


<div class="viewcode-block" id="table_control_class.move_to_strip"><a class="viewcode-back" href="../code.html#utilities.table_control_class.move_to_strip">[docs]</a>    <span class="k">def</span> <span class="nf">move_to_strip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad_file</span><span class="p">,</span> <span class="n">strip</span><span class="p">,</span> <span class="n">transfomation_class</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">height_movement</span> <span class="o">=</span> <span class="mi">800</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Moves to a specific strip</span>

<span class="sd">        :param transfomation_class:</span>
<span class="sd">        :param height_movement: How much should the table move down</span>
<span class="sd">        :return: None or errorcode</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">error</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">transformation</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__already_there</span><span class="p">(</span><span class="n">pad_file</span><span class="p">,</span> <span class="n">strip</span><span class="p">,</span> <span class="n">transfomation_class</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
                <span class="n">pad_pos</span> <span class="o">=</span> <span class="n">pad_file</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="n">strip</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">l</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Moving to strip: </span><span class="si">{}</span><span class="s2"> at position </span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strip</span><span class="p">,</span> <span class="n">pad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pad_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">table_abs_pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">transfomation_class</span><span class="o">.</span><span class="n">vector_trans</span><span class="p">(</span><span class="n">pad_pos</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V0</span><span class="p">))</span>
                <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">table_abs_pos</span><span class="p">,</span> <span class="n">move_down</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lifting</span> <span class="o">=</span> <span class="n">height_movement</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;current_strip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">strip</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;No Transformation Matrix found! Is the alignment done?&quot;</span><span class="p">}</span></div>


<div class="viewcode-block" id="table_control_class.relative_move_to"><a class="viewcode-back" href="../code.html#utilities.table_control_class.relative_move_to">[docs]</a>    <span class="k">def</span> <span class="nf">relative_move_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">move_down</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">lifting</span> <span class="o">=</span> <span class="mi">800</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function moves the table to the desired position (relative). position is a list of coordinates</span>
<span class="sd">        The move down parameter can prohibit a down and up movement with the move, !!!!USE WITH CARE!!!!</span>

<span class="sd">        :return: none or error code</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">move_down</span><span class="p">,</span> <span class="n">lifting</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">error</span></div>


<div class="viewcode-block" id="table_control_class.move_to"><a class="viewcode-back" href="../code.html#utilities.table_control_class.move_to">[docs]</a>    <span class="k">def</span> <span class="nf">move_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">move_down</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">lifting</span>  <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">relative_move</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function moves the table to the desired position. position is a list of coordinates</span>
<span class="sd">        The move down parameter can prohibits a down and up movement with the move, !!!!USE WITH CARE!!!!</span>

<span class="sd">        :return: None or errorcode</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_is_moving&quot;</span><span class="p">]:</span>
            <span class="c1"># get me the current position</span>
            <span class="n">old_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
            <span class="n">desired_pos</span> <span class="o">=</span> <span class="n">position</span><span class="p">[:]</span>

            <span class="c1">#Move the table down if necessary</span>
            <span class="k">if</span> <span class="n">move_down</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_down</span><span class="p">(</span><span class="n">lifting</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">relative_move</span><span class="p">:</span>
                    <span class="n">desired_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lifting</span> <span class="c1"># To counter the down movement</span>
                <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">error</span>

            <span class="c1"># Change the state of the table</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_is_moving&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1">#pos_string = &quot;&quot;</span>

            <span class="c1"># Build the position to move to</span>
            <span class="c1">#for i, pos in enumerate(position): # This is that the table is in the down position when moved</span>
            <span class="c1">#    if move_down and i==2 and not relative_move:</span>
            <span class="c1">#        pos_string += str(float(pos)-float(lifting)) + &quot; &quot;</span>
            <span class="c1">#    else:</span>
            <span class="c1">#        pos_string += str(pos) + &quot; &quot;</span>

            <span class="c1"># Move the table to the position</span>
            <span class="k">if</span> <span class="n">relative_move</span><span class="p">:</span>
                <span class="n">move_command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_relative_move_to&quot;</span><span class="p">,</span> <span class="n">desired_pos</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">move_command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_move_to&quot;</span><span class="p">,</span> <span class="n">desired_pos</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">move_command</span><span class="p">)</span>
            <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_if_ready</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">error</span>

            <span class="c1"># State that the table is not moving anymore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_is_moving&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Move the table back up again</span>
            <span class="k">if</span> <span class="n">move_down</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_up</span><span class="p">(</span><span class="n">lifting</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">error</span>

            <span class="c1"># Finally make sure the position is correct</span>
            <span class="k">if</span> <span class="n">relative_move</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_position</span><span class="p">([</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">old_pos</span><span class="p">,</span> <span class="n">position</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_position</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">error</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;table_is_moving&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="table_control_class.move_up"><a class="viewcode-back" href="../code.html#utilities.table_control_class.move_up">[docs]</a>    <span class="k">def</span> <span class="nf">move_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lifting</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function moves the table up</span>

<span class="sd">        :param lifting:  hight movement</span>
<span class="sd">        :return: none or errorcode</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Table_state&quot;</span><span class="p">]:</span>
            <span class="n">errorcode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lifting</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">errorcode</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Table_state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">errorcode</span>
        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="table_control_class.move_down"><a class="viewcode-back" href="../code.html#utilities.table_control_class.move_down">[docs]</a>    <span class="k">def</span> <span class="nf">move_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lifting</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function moves the table down</span>

<span class="sd">        :param lifting:  hight movement</span>
<span class="sd">        :return: none or errorcode</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Table_state&quot;</span><span class="p">]:</span>
            <span class="n">errorcode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">lifting</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">errorcode</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;Table_state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">errorcode</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    <span class="nd">@hf</span><span class="o">.</span><span class="n">raise_exception</span>
    <span class="k">def</span> <span class="nf">set_joystick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;This enables or disables the joystick&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_joystick&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_joystick&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>

<div class="viewcode-block" id="table_control_class.set_joystick_speed"><a class="viewcode-back" href="../code.html#utilities.table_control_class.set_joystick_speed">[docs]</a>    <span class="k">def</span> <span class="nf">set_joystick_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;This sets the speed for the joystick&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_joy_speed&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">speed</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span></div>

<div class="viewcode-block" id="table_control_class.set_axis"><a class="viewcode-back" href="../code.html#utilities.table_control_class.set_axis">[docs]</a>    <span class="k">def</span> <span class="nf">set_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis_list</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;This sets the axis on or off. axis_list must contain a list of type [x=bool, y=bool, z=bool]&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span><span class="p">:</span>
            <span class="n">final_axis_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axis_list</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">axis</span><span class="p">:</span>
                    <span class="n">final_axis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;1 &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">final_axis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;0 &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_axis&quot;</span><span class="p">,</span> <span class="n">final_axis_list</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">com</span> <span class="ow">in</span> <span class="n">command</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="p">,</span> <span class="n">com</span><span class="p">)</span></div>


<div class="viewcode-block" id="table_control_class.stop_move"><a class="viewcode-back" href="../code.html#utilities.table_control_class.stop_move">[docs]</a>    <span class="k">def</span> <span class="nf">stop_move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;This function stops the table movement immediately&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_ready</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;abort_movement&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visa_resource</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">command</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="switching_control"><a class="viewcode-back" href="../code.html#utilities.switching_control">[docs]</a><span class="k">class</span> <span class="nc">switching_control</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class handles all switching controls of all switching matrices</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="n">queue_to_main</span><span class="p">,</span> <span class="n">shell</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This class handles all switching actions</span>

<span class="sd">        :param settings: default settings ( state machine )</span>
<span class="sd">        :param devices: devices dict</span>
<span class="sd">        :param shell: UniDAQ shell object</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_to_main</span> <span class="o">=</span> <span class="n">queue_to_main</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">devices</span> <span class="o">=</span> <span class="n">devices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span> <span class="o">=</span> <span class="n">VisaConnectWizard</span><span class="o">.</span><span class="n">VisaConnectWizard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shell</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">build_command</span>

<div class="viewcode-block" id="switching_control.reset_switching"><a class="viewcode-back" href="../code.html#utilities.switching_control.reset_switching">[docs]</a>    <span class="k">def</span> <span class="nf">reset_switching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function resets all switching or one device switching</span>
<span class="sd">        :param device: all oder device object:</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">device</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span> <span class="c1"># opens all switches in all relays</span>
            <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="s2">&quot;Switching relay&quot;</span> <span class="ow">in</span> <span class="n">dev</span><span class="p">[</span><span class="s2">&quot;Device_type&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">change_switching</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="p">[])</span> <span class="c1"># Opens all closed switches</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">change_switching</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="switching_control.check_switching_action"><a class="viewcode-back" href="../code.html#utilities.switching_control.check_switching_action">[docs]</a>    <span class="k">def</span> <span class="nf">check_switching_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks what channels are closed on all switching devices&quot;&quot;&quot;</span>
        <span class="n">current_switching</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">devices</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;Switching relay&quot;</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">[</span><span class="s2">&quot;Device_type&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="s2">&quot;Visa_Resource&quot;</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">devices</span><span class="p">,</span> <span class="s2">&quot;check_all_closed_channel&quot;</span><span class="p">)</span>
                <span class="n">switching</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">devices</span><span class="p">,</span> <span class="n">command</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">switching</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick_switch_response</span><span class="p">(</span><span class="n">devices</span><span class="p">,</span> <span class="n">switching</span><span class="p">)</span>
                <span class="n">current_switching</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">devices</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">]:</span> <span class="n">switching</span><span class="p">})</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Defaults&quot;</span><span class="p">][</span><span class="s2">&quot;current_switching&quot;</span><span class="p">][</span><span class="n">devices</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">current_switching</span>
        <span class="k">return</span> <span class="n">current_switching</span></div>

<div class="viewcode-block" id="switching_control.apply_specific_switching"><a class="viewcode-back" href="../code.html#utilities.switching_control.apply_specific_switching">[docs]</a>    <span class="k">def</span> <span class="nf">apply_specific_switching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">switching_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This function takes a dict of type {&quot;Switching&quot;: [/switch nodes], ....} and switches to these specific type&quot;&quot;&quot;</span>

        <span class="n">num_devices</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">switching_dict</span><span class="p">)</span> <span class="c1"># how many devices need to be switched</span>
        <span class="n">devices_found</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">devices</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">values</span><span class="p">():</span> <span class="c1"># Loop over all devices values (we need the display name)</span>
            <span class="k">for</span> <span class="n">display_names</span> <span class="ow">in</span> <span class="n">switching_dict</span><span class="p">:</span> <span class="c1"># extract all devices names for identification</span>
                <span class="k">if</span> <span class="n">display_names</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">]:</span>
                    <span class="n">switching_success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_switching</span><span class="p">(</span><span class="n">devices</span><span class="p">,</span> <span class="n">switching_dict</span><span class="p">[</span><span class="n">display_names</span><span class="p">])</span>
                    <span class="n">devices_found</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">num_devices</span> <span class="o">!=</span> <span class="n">devices_found</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;At least one switching was not possible, no devices for switching included/connected&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_to_main</span><span class="o">.</span><span class="n">put</span><span class="p">({</span><span class="s2">&quot;MeasError&quot;</span><span class="p">:</span> <span class="s2">&quot;At least one switching was not possible, no devices for switching included/connected&quot;</span><span class="p">})</span>
            <span class="n">switching_success</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">switching_success</span></div>


<div class="viewcode-block" id="switching_control.switch_to_measurement"><a class="viewcode-back" href="../code.html#utilities.switching_control.switch_to_measurement">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_measurement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function switches all switching systems to a specific measurement type</span>

<span class="sd">        :param measurement: string e.g. &quot;IV&quot;, &quot;CV&quot; must be defined in the switching dict</span>
<span class="sd">        :return: true or false, so if switching was successfull or not</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1">#Todo: Brandbox is sended twice due to double occurance (humidity controller), but maybe its for the best, since the thing isnt working properly</span>
        <span class="c1"># First find measurement</span>
        <span class="n">switching_success</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Switching&quot;</span><span class="p">]:</span>
            <span class="c1"># When measurement was found</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">switch_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Switching&quot;</span><span class="p">][</span><span class="n">measurement</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">device_found</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">devices</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">]:</span>
                        <span class="n">device</span> <span class="o">=</span> <span class="n">devices</span>
                        <span class="n">switching_success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_switching</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">switch_list</span><span class="p">)</span>
                        <span class="n">device_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">device_found</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">message_to_main</span><span class="o">.</span><span class="n">put</span><span class="p">({</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;Switching device: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not found in active resources. No switching done!&quot;</span><span class="p">})</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">switching_success</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Measurement &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; switching could not be found in defined switching schemes.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_to_main</span><span class="o">.</span><span class="n">put</span><span class="p">({</span><span class="s2">&quot;MeasError&quot;</span><span class="p">:</span> <span class="s2">&quot;Measurement &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; switching could not be found in defined switching schemes.&quot;</span><span class="p">})</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">__send_switching_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">list_of_commands</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a switching command&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">list_of_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">list_of_commands</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">list_of_commands</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>  <span class="c1"># Write new switching</span>

<div class="viewcode-block" id="switching_control.pick_switch_response"><a class="viewcode-back" href="../code.html#utilities.switching_control.pick_switch_response">[docs]</a>    <span class="k">def</span> <span class="nf">pick_switch_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">current_switching</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function picks the string response and returns a list.</span>
<span class="sd">        :param current_switching: is a string containing the current switching</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">syntax_list</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;syntax&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">syntax_list</span><span class="p">:</span>
            <span class="n">syntax_list</span> <span class="o">=</span> <span class="n">syntax_list</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;###&quot;</span><span class="p">)</span><span class="c1"># gets me header an footer from syntax</span>

        <span class="c1"># Warning 7001 keithley sometimes seperates values by , and sometimes by : !!!!!!!!!</span>
        <span class="c1"># Sometimes it also happens that it mixes everything -&gt; this means that the channel from to are closed etc.</span>
        <span class="c1"># Todo: implement the : exception</span>

        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">current_switching</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;The switching syntax for this is not yet implemented, discrepancies do occure from displayed to actually switched case. TODO&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">current_switching</span><span class="p">:</span> <span class="c1"># if this shitty mix happens</span>
                <span class="n">current_switching</span> <span class="o">=</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">current_switching</span> <span class="o">=</span> <span class="n">current_switching</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="k">return</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>  <span class="c1"># now we have the right commands</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>  <span class="c1"># now we have the right commands</span>

        <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">current_switching</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">current_switching</span><span class="p">:</span> <span class="c1"># if this shitty mix happens</span>
                <span class="n">current_switching</span> <span class="o">=</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">current_switching</span> <span class="o">=</span> <span class="n">current_switching</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="c1">#current_switching = current_switching.split(syntax_list[0]).split(syntax_list[1])</span>
                <span class="k">return</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="c1"># now we have the right commands</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="c1"># now we have the right commands</span>

        <span class="k">elif</span> <span class="s2">&quot;@&quot;</span> <span class="ow">in</span> <span class="n">current_switching</span><span class="p">:</span> <span class="c1"># if no switching at all happens</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">current_switching</span> <span class="o">=</span> <span class="n">current_switching</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">syntax_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="k">return</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># now we have the right commands</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># now we have the right commands</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">current_switching</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># now we have the right commands</span></div>

    <span class="nd">@hf</span><span class="o">.</span><span class="n">raise_exception</span>
    <span class="c1">#@hf.run_with_lock</span>
    <span class="k">def</span> <span class="nf">change_switching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span> <span class="c1"># Has to be a string command or a list of commands containing strings!!</span>

        <span class="c1">#TODO: Switching better!!!</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Fancy name, but just sends the swithing command</span>

<span class="sd">        :param config: the list of nodes which need to be switched</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># TODO: check when switching was not possible that the programm shutsdown! Now the due to the brandbox this is switched off</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="o">==</span> <span class="n">unicode</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">configs</span> <span class="o">=</span> <span class="p">[</span><span class="n">config</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">configs</span> <span class="o">=</span> <span class="n">config</span>

        <span class="k">if</span> <span class="s2">&quot;Visa_Resource&quot;</span> <span class="ow">in</span> <span class="n">device</span><span class="p">:</span> <span class="c1">#Searches for the visa resource</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s2">&quot;Visa_Resource&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_to_main</span><span class="o">.</span><span class="n">put</span><span class="p">({</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;The VISA resource for device &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; could not be found. No switching possible.&quot;</span><span class="p">})</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s2">&quot;check_all_closed_channel&quot;</span><span class="p">)</span>
        <span class="n">current_switching</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">command</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># Get current switching</span>
        <span class="n">current_switching</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick_switch_response</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">current_switching</span><span class="p">)</span>

        <span class="n">to_open_channels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_switching</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">configs</span><span class="p">)))</span>  <span class="c1"># all channels which need to be closed</span>
        <span class="n">to_close_channels</span> <span class="o">=</span> <span class="n">configs</span>

        <span class="c1"># Close channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__send_switching_command</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s2">&quot;set_close_channel&quot;</span><span class="p">,</span> <span class="n">to_close_channels</span><span class="p">)</span>

        <span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="c1"># Just for safety reasons because the brandbox is very slow</span>

        <span class="c1"># Open channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__send_switching_command</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s2">&quot;set_open_channel&quot;</span><span class="p">,</span> <span class="n">to_open_channels</span><span class="p">)</span>

        <span class="c1"># Check if switching is done (basically the same proceedure like before only in the end there is a check</span>

        <span class="n">device_not_ready</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">device_not_ready</span><span class="p">:</span>
            <span class="n">current_switching</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s2">&quot;operation_complete&quot;</span><span class="p">)</span>
            <span class="n">all_done</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">command</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">all_done</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span> <span class="ow">or</span> <span class="n">all_done</span> <span class="o">==</span> <span class="s2">&quot;Done&quot;</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s2">&quot;check_all_closed_channel&quot;</span><span class="p">)</span>
                <span class="n">current_switching</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcw</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">command</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">current_switching</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick_switch_response</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">current_switching</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Defaults&quot;</span><span class="p">][</span><span class="s2">&quot;current_switching&quot;</span><span class="p">][</span><span class="n">device</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">current_switching</span>

                <span class="n">command_diff</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_switching</span><span class="p">)))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_diff</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1">#Checks if all the right channels are closed</span>
                    <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Switching to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not possible. Difference read: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_switching</span><span class="p">))</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Switching to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not possible. Difference read: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_switching</span><span class="p">))</span>
                    <span class="n">device_not_ready</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="n">device_not_ready</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">device_not_ready</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">l</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No response from switching system: &quot;</span> <span class="o">+</span> <span class="n">device</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_to_main</span><span class="o">.</span><span class="n">put</span><span class="p">({</span><span class="s2">&quot;RequestError&quot;</span><span class="p">:</span> <span class="s2">&quot;No response from switching system: &quot;</span> <span class="o">+</span> <span class="n">device</span><span class="p">[</span><span class="s2">&quot;Display_name&quot;</span><span class="p">]})</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="switching_control.build_command_depricated"><a class="viewcode-back" href="../code.html#utilities.switching_control.build_command_depricated">[docs]</a>    <span class="k">def</span> <span class="nf">build_command_depricated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">command_tuple</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds the command correctly, so that the device recognise the command</span>

<span class="sd">        :param device: device dictionary</span>
<span class="sd">        :param command_tuple: (command, value), can also be a string for a final command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="n">unicode</span><span class="p">:</span>
            <span class="n">command_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">),)</span> <span class="c1"># so the correct casting is done</span>

        <span class="c1"># Make a loop over all items in the device dict</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">device</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Search for the command in the dict</span>
                <span class="k">if</span> <span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span> <span class="c1"># finds the correct value</span>
                    <span class="n">command_keyword</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># extract the keyword, the essence of the command</span>

                    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;CSV_command_&quot;</span> <span class="o">+</span> <span class="n">command_keyword</span><span class="p">)</span> <span class="ow">in</span> <span class="n">device</span><span class="p">:</span> <span class="c1"># searches for CSV command in dict</span>
                        <span class="n">data_struct</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s2">&quot;CSV_command_&quot;</span> <span class="o">+</span> <span class="n">command_keyword</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

                        <span class="n">final_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>  <span class="c1"># so the key word</span>

                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">given_orders</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span> <span class="c1"># so if more values are given, these will be processed first</span>
                            <span class="n">final_string</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">given_orders</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>  <span class="c1"># so the value</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_struct</span><span class="p">):</span> <span class="c1"># searches if additional data needs to be added</span>
                            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_struct</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]:</span>
                                <span class="c1"># print device[command_keyword + &quot;_&quot; + data]</span>
                                <span class="k">if</span> <span class="n">command_keyword</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">device</span><span class="p">:</span>
                                    <span class="n">final_string</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="n">command_keyword</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">])</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">final_string</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span><span class="c1"># if no such value is in the dict</span>

                        <span class="k">return</span> <span class="n">final_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># because there is a colon to much in it</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">command_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1">#print e</span>
                <span class="k">pass</span></div></div>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="nb">print</span> <span class="s2">&quot;test&quot;</span>

    <span class="n">device_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;set_source_current&quot;</span><span class="p">:</span> <span class="s2">&quot;SOUR:FUNC CURR&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;2410 Keithley SMU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_current_range&quot;</span><span class="p">:</span> <span class="s2">&quot;10E-6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_current_range&quot;</span><span class="p">:</span> <span class="s2">&quot;SENS:CURR:RANG &quot;</span><span class="p">,</span>
    <span class="s2">&quot;Flow_control&quot;</span><span class="p">:</span> <span class="s2">&quot;ON&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_output&quot;</span><span class="p">:</span> <span class="s2">&quot;OFF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_measure_current&quot;</span><span class="p">:</span> <span class="s2">&quot;SENS:FUNC &#39;CURR&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_terminal&quot;</span><span class="p">:</span> <span class="s2">&quot;REAR&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Read&quot;</span><span class="p">:</span> <span class="s2">&quot;READ?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_source_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;SOUR:FUNC VOLT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_voltage_range&quot;</span><span class="p">:</span> <span class="s2">&quot;SOUR:VOLT:RANG &quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_reading_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;CURR&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SMU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;imp:default_reading_count&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_measurement_speed&quot;</span><span class="p">:</span> <span class="s2">&quot;SENS:RES:NPLC &quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_beep&quot;</span><span class="p">:</span> <span class="s2">&quot;SYST:BEEP:STAT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;GPIB:16&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;SMU2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_reading_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;FORM:ELEM &quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_reading_count&quot;</span><span class="p">:</span> <span class="s2">&quot;TRIG:COUN &quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_measure_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;SENS:FUNC &#39;VOLT&#39;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_voltage_range&quot;</span><span class="p">:</span> <span class="s2">&quot;1000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_complience&quot;</span><span class="p">:</span> <span class="s2">&quot;SENS:CURR:PROT &quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_terminal&quot;</span><span class="p">:</span> <span class="s2">&quot;ROUT:TERM&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Baud_rate&quot;</span><span class="p">:</span> <span class="mi">57600</span><span class="p">,</span>
    <span class="s2">&quot;set_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;SOUR:VOLT:LEV &quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_IDN&quot;</span><span class="p">:</span> <span class="s2">&quot;KEITHLEY INSTRUMENTS INC.,MODEL 2410,0854671,C33   Mar 31 2015 09:32:39/A02  /J/H&quot;</span><span class="p">,</span>
    <span class="s2">&quot;imp:default_voltage_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;FIXED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_measurement_speed&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_complience&quot;</span><span class="p">:</span> <span class="s2">&quot;100E-6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_beep&quot;</span><span class="p">:</span> <span class="s2">&quot;OFF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_output&quot;</span><span class="p">:</span> <span class="s2">&quot;OUTP &quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_voltage_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;SOUR:VOLT:MODE &quot;</span>
        <span class="p">}</span>

    <span class="n">device_237</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default_integration_time&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;separator&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;237 Keithley SMU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_output_dataformat&quot;</span><span class="p">:</span> <span class="s2">&quot;4,2,0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_terminator&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_local_sense&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_local_sense&quot;</span><span class="p">:</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span>
    <span class="s2">&quot;imp:default_trigger&quot;</span><span class="p">:</span> <span class="s2">&quot;2,0,0,0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Read&quot;</span><span class="p">:</span> <span class="s2">&quot;H0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SMU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_triggerONOFF&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_measure_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSV_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;voltage,range,delay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;GPIB:18&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_triggerONOFF&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;0,0,0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;SMU1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_terminator&quot;</span><span class="p">:</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_output&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_complience&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;complience_range&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_trigger&quot;</span><span class="p">:</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSV_complience&quot;</span><span class="p">:</span> <span class="s2">&quot;complience,range&quot;</span><span class="p">,</span>
    <span class="s2">&quot;voltage_range&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reset_device&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;J0&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Device_IDN&quot;</span><span class="p">:</span> <span class="s2">&quot;237A10&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_output_dataformat&quot;</span><span class="p">:</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_integration_time&quot;</span><span class="p">:</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_terminator&quot;</span><span class="p">:</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span>
    <span class="s2">&quot;voltage_delay&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_complience&quot;</span><span class="p">:</span> <span class="s2">&quot;5E-6,0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;logical_operation&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_measure_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;0,0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;device_IDN_query&quot;</span><span class="p">:</span> <span class="s2">&quot;U0X&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_output&quot;</span><span class="p">:</span> <span class="s2">&quot;N&quot;</span>
    <span class="p">}</span>

    <span class="n">device_table</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;set_umotgrad&quot;</span><span class="p">:</span> <span class="s2">&quot;setumotgrad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;calibrate_motor&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;calibrate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rm&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;abort_movement&quot;</span><span class="p">:</span> <span class="s2">&quot;Ctrl C&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_acceleration&quot;</span><span class="p">:</span> <span class="s2">&quot;setaccel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;error_query&quot;</span><span class="p">:</span> <span class="s2">&quot;geterror&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table_zmax&quot;</span><span class="p">:</span> <span class="s2">&quot;11100.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ITK Corvus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_joy_speed&quot;</span><span class="p">:</span> <span class="s2">&quot;10000.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;command_order&quot;</span><span class="p">:</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_speed&quot;</span><span class="p">:</span> <span class="s2">&quot;getvel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;current_speed&quot;</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
    <span class="s2">&quot;table_ymax&quot;</span><span class="p">:</span> <span class="s2">&quot;193000.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_joysticktype&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_pos_from_init&quot;</span><span class="p">:</span> <span class="s2">&quot;devpos&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_axis&quot;</span><span class="p">:</span> <span class="s2">&quot;setaxis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_acceleration&quot;</span><span class="p">:</span> <span class="s2">&quot;3000.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_pitch&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1.0 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1.0 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1.0 3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1.0 0&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;default_dimension&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_units&quot;</span><span class="p">:</span> <span class="s2">&quot;setunit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_axis_scale&quot;</span><span class="p">:</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_acceleration&quot;</span><span class="p">:</span> <span class="s2">&quot;getaccel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_speed&quot;</span><span class="p">:</span> <span class="s2">&quot;10000.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_motiondir&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;0,3&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;default_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table_xmin&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Motor control&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_joystick&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_joy_speed&quot;</span><span class="p">:</span> <span class="s2">&quot;setjoyspeed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_umotmin&quot;</span><span class="p">:</span> <span class="s2">&quot;setumotmin&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_axis_scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0 1.0 1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_umotgrad&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;55 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;55 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;55 3&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;set_dimension&quot;</span><span class="p">:</span> <span class="s2">&quot;setdim&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table_ymin&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;imp:default_units&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1 3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1 0&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;set_speed&quot;</span><span class="p">:</span> <span class="s2">&quot;setvel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table_xmax&quot;</span><span class="p">:</span> <span class="s2">&quot;97300.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_move_to&quot;</span><span class="p">:</span> <span class="s2">&quot;move&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSV_move_to&quot;</span><span class="p">:</span> <span class="s2">&quot;x,y,z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;selftest&quot;</span><span class="p">:</span> <span class="s2">&quot;selftest&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;RS232:1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;all_done&quot;</span><span class="p">:</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_axis&quot;</span><span class="p">:</span> <span class="s2">&quot;getaxis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_motiondir&quot;</span><span class="p">:</span> <span class="s2">&quot;setmotiondir&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_relative_move_to&quot;</span><span class="p">:</span> <span class="s2">&quot;rmove&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSV_relative_move_to&quot;</span><span class="p">:</span> <span class="s2">&quot;x,y,z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Baud_rate&quot;</span><span class="p">:</span> <span class="s2">&quot;9600&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reset_device&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;restore&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ico&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clear&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;get_position&quot;</span><span class="p">:</span> <span class="s2">&quot;pos&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_axis&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1 3&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Device_IDN&quot;</span><span class="p">:</span> <span class="s2">&quot;Corvus 1 462 1 0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_pitch&quot;</span><span class="p">:</span> <span class="s2">&quot;setpitch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_joystick&quot;</span><span class="p">:</span> <span class="s2">&quot;joystick&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table_zmin&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_joysticktype&quot;</span><span class="p">:</span> <span class="s2">&quot;setjoysticktype&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Corvus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_umotmin&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1850 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1850 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1850 3&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;device_IDN_query&quot;</span><span class="p">:</span> <span class="s2">&quot;identify&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_polepairs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;50 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;50 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;50 3&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;set_polepairs&quot;</span><span class="p">:</span> <span class="s2">&quot;setpolepairs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;separator&quot;</span><span class="p">:</span> <span class="s2">&quot; &quot;</span>
    <span class="p">}</span>

    <span class="n">device_switch</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;GPIB:14&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Switching&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Device_IDN&quot;</span><span class="p">:</span> <span class="s2">&quot;KEITHLEY INSTRUMENTS INC.,MODEL 7001, 503327,A04  /A01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;check_all_closed_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos:STAT?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Matrix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;check_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:open&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set_open_all&quot;</span><span class="p">:</span> <span class="s2">&quot;:open all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CSV_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CSV_close_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;separator&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Device_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Switching relay&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set_close_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos&quot;</span><span class="p">,</span>
        <span class="s2">&quot;syntax&quot;</span><span class="p">:</span> <span class="s2">&quot;(@###)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;operation_complete&quot;</span><span class="p">:</span> <span class="s2">&quot;*OPC?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;no_syntax_with_single_commmand&quot;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>

    <span class="n">device_object</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;GPIB:14&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Switching&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Device_IDN&quot;</span><span class="p">:</span> <span class="s2">&quot;KEITHLEY INSTRUMENTS INC.,MODEL 7001, 503327,A04  /A01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;check_all_closed_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos:STAT?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Matrix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;check_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:open&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CSV_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CSV_close_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;seperator&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Device_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Switching relay&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set_close_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos&quot;</span><span class="p">,</span>
        <span class="s2">&quot;syntax&quot;</span><span class="p">:</span> <span class="s2">&quot;(@###)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;operation_complete&quot;</span><span class="p">:</span> <span class="s2">&quot;*OPC?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;no_syntax_with_single_commmand&quot;</span><span class="p">:</span> <span class="kc">True</span>
            <span class="p">}</span>

    <span class="n">HV_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;RS232:15&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_relay_state&quot;</span><span class="p">:</span> <span class="s2">&quot;GET:&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Brand Box&quot;</span><span class="p">,</span>
    <span class="s2">&quot;enviroment_query&quot;</span><span class="p">:</span> <span class="s2">&quot;GET:ENV ?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bias_relay&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_discharge&quot;</span><span class="p">:</span> <span class="s2">&quot;SET:DISCHARGE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_external_light&quot;</span><span class="p">:</span> <span class="s2">&quot;SET:BOX_LED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;HV_box&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_environement_control&quot;</span><span class="p">:</span> <span class="s2">&quot;SET:CTRL&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_status&quot;</span><span class="p">:</span> <span class="s2">&quot;*STB?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_IDN&quot;</span><span class="p">:</span> <span class="s2">&quot;HV-Relay Controller V1.4/02.Oct.2018&quot;</span><span class="p">,</span>
    <span class="s2">&quot;check_all_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:open:STAT?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:open&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSV_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSV_close_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_external_light&quot;</span><span class="p">:</span> <span class="s2">&quot;OFF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_open_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;A1,A2,B1,B2,C1,C2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_close_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_lock_switch&quot;</span><span class="p">:</span> <span class="s2">&quot;GET:TST&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;SET:MOD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;set_relay&quot;</span><span class="p">:</span> <span class="s2">&quot;SET:&quot;</span><span class="p">,</span>
    <span class="s2">&quot;check_all_closed_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos:STAT?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;check_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;:clos?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LCR_relay&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Device_type&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Switching relay&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Light controller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Environment controller&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;lock_switches&quot;</span><span class="p">:</span> <span class="s2">&quot;SET:TST&quot;</span><span class="p">,</span>
    <span class="s2">&quot;operation_complete&quot;</span><span class="p">:</span> <span class="s2">&quot;*OPC?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;separator&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span>
<span class="p">}</span>

    <span class="n">dict_2657</span><span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;Device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;2657 Keithley SMU&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bias_SMU&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Device_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SMU&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;GPIB:26&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Device_IDN&quot;</span><span class="p">:</span> <span class="s2">&quot;Keithley Instruments Inc., Model 2657A, 4356871, 1.1.5&quot;</span><span class="p">,</span>
  <span class="s2">&quot;syntax&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;separator&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_enable_beeper&quot;</span><span class="p">:</span> <span class="s2">&quot;beeper.enable =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_enable_beeper&quot;</span><span class="p">:</span> <span class="s2">&quot;beeper.ON&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_beep&quot;</span><span class="p">:</span> <span class="s2">&quot;beeper.beep&quot;</span><span class="p">,</span>
  <span class="s2">&quot;CSV_beep&quot;</span><span class="p">:</span> <span class="s2">&quot;time, frequency&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_delay&quot;</span><span class="p">:</span> <span class="s2">&quot;delay&quot;</span><span class="p">,</span>
  <span class="s2">&quot;clear_display&quot;</span><span class="p">:</span> <span class="s2">&quot;display.clear()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;get_annuciators&quot;</span><span class="p">:</span> <span class="s2">&quot;print(display.getannuciators())&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_lock_SMU&quot;</span><span class="p">:</span> <span class="s2">&quot;display.locallockout =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_lock_SMU&quot;</span><span class="p">:</span> <span class="s2">&quot;display.LOCK&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_display_measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;display.screen =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_display_measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;display.SMUA&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_display_text&quot;</span><span class="p">:</span> <span class="s2">&quot;display.settext&quot;</span><span class="p">,</span>
  <span class="s2">&quot;CSV_display_text&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
  <span class="s2">&quot;display_clear&quot;</span><span class="p">:</span> <span class="s2">&quot;display.clear()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;display_dcamps&quot;</span><span class="p">:</span> <span class="s2">&quot;display.smua.measure.func = display.MEASURE_DCAMPS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;display_dcvolts&quot;</span><span class="p">:</span> <span class="s2">&quot;display.smua.measure.func = display.MEASURE_DCVOLTS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;display_dcohms&quot;</span><span class="p">:</span> <span class="s2">&quot;display.smua.measure.func = display.MEASURE_DCOHMS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;display_dcwatts&quot;</span><span class="p">:</span> <span class="s2">&quot;display.smua.measure.func = display.MEASURE_DCWATTS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_display_func&quot;</span><span class="p">:</span> <span class="s2">&quot;display.smua.measure.func =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_display_func&quot;</span><span class="p">:</span> <span class="s2">&quot;display.MEASURE_DCAMPS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;clear_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;errorqueue.clear()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;get_error_count&quot;</span><span class="p">:</span> <span class="s2">&quot;print(errorqueue.count)&quot;</span><span class="p">,</span>
  <span class="s2">&quot;get_next_error&quot;</span><span class="p">:</span> <span class="s2">&quot;errorcode, message, severity = errorqueue.next() </span><span class="se">\n</span><span class="s2"> print(errorcode, message, severity)&quot;</span><span class="p">,</span>
  <span class="s2">&quot;exit_script&quot;</span><span class="p">:</span> <span class="s2">&quot;exit()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;initialize_lan&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.applysettings()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_lan_autoconnect&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.autoconnect =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_lan_autoconnect&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.ENABLE&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_DNS&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.config.dns.address[1] = &#39;0.0.0.0&#39;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_domain&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.config.dns.domain = &#39;0.0.0.0&#39;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.config.dns.hostname = &#39;2657KeithleySMU&#39;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_verify_host&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.config.dns.verify =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_verify_host&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.ENABLE&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_gateway&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.config.gateway =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_gateway&quot;</span><span class="p">:</span> <span class="s2">&quot;&#39;192.168.0.1&#39;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_ipaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.config.ipaddress =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_ipaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;&#39;192.168.0.100&#39;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_lan_config&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.config.method =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_lan_config&quot;</span><span class="p">:</span>  <span class="s2">&quot;lan.MANUAL&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reset_lan_interface&quot;</span><span class="p">:</span> <span class="s2">&quot;lan.reset()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;device_IDN_query&quot;</span><span class="p">:</span> <span class="s2">&quot;*IDN?&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reset_device&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*rst&quot;</span><span class="p">],</span>
  <span class="s2">&quot;abort&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.abort()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;store_calibration&quot;</span><span class="p">:</span> <span class="s2">&quot;sma.cal.save()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;calibrate_highsense&quot;</span><span class="p">:</span> <span class="s2">&quot;smuX.contact.calibratehi()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;calibrate_lo&quot;</span><span class="p">:</span> <span class="s2">&quot;smuX.contact.calibratelo()&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_autorange_current&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.autorangei =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_autorange_current&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_autorange_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.autorangev =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_autorange_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_autozero&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.autozero =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_autozero&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.AUTOZERO_AUTO&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_measurement_count&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.count =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_measurement_count&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_filter_count&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.filter.count =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_filter_count&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_filter_enable&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.filter.enable =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_filter_enable&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.FILTER_ON&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.filter.type =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.FILTER_REPEAT_AVG&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_current_range_low&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.lowrangei = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_voltage_range_low&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.lowrangev = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_voltage_range_low&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_current_range_low&quot;</span><span class="p">:</span> <span class="s2">&quot;100e-12&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_NPLC&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.measure.nplc = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_NPLC&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Read_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;print(smua.measure.v())&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Read_current&quot;</span><span class="p">:</span> <span class="s2">&quot;print(smua.measure.i())&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Read_iv&quot;</span><span class="p">:</span> <span class="s2">&quot;print(smua.measure.iv())&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Read&quot;</span><span class="p">:</span> <span class="s2">&quot;print(smua.measure.i())&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_source_current_autorange&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.autorangei = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_source_voltage_autorange&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.autorangev = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_source_current_autorange&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.AUTORANGE_ON&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_source_voltage_autorange&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.AUTORANGE_ON&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_source_func&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.func =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_source_func&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.OUTPUT_DCVOLTS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.levelv = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_source_level_volts&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.levelv = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_source_level_volts&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_complience_current&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.limiti = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_complience&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.limiti = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_complience_current&quot;</span><span class="p">:</span> <span class="s2">&quot;50e-6&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_complience_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.limiti = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_complience_voltage&quot;</span><span class="p">:</span> <span class="s2">&quot;1000&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_offvoltage&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.offfunc =&quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_offvoltage&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.OUTPUT_DCVOLTS&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_offcomplience&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.offlimiti = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_offcomplience&quot;</span><span class="p">:</span> <span class="s2">&quot;50e-6&quot;</span><span class="p">,</span>
  <span class="s2">&quot;set_output&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.source.output = &quot;</span><span class="p">,</span>
  <span class="s2">&quot;default_output&quot;</span><span class="p">:</span> <span class="s2">&quot;smua.OUTPUT_OFF&quot;</span><span class="p">,</span>
  <span class="s2">&quot;no_syntax_with_single_commmand&quot;</span><span class="p">:</span> <span class="kc">True</span>

<span class="p">}</span>

    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">dict_2657</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_voltage&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)))</span>


    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">HV_dict</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_discharge&quot;</span><span class="p">,</span> <span class="s2">&quot;ON&quot;</span><span class="p">)))</span>

    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_open_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;1!1!1, 1!2!3, 2!3!3, 3!5!6&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_open_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;(1!1!1, 1!2!3, 2!3!3)&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_open_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;[1!1!1, 1!2!3, 2!3!3]&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_open_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;1!1!1&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_open_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="s2">&quot;set_open_all&quot;</span><span class="p">))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_open_channel&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_switch</span><span class="p">,</span> <span class="s2">&quot;check_all_closed_channel&quot;</span><span class="p">))</span>


    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_move_to&quot;</span><span class="p">,</span> <span class="s2">&quot;0, 0, 0&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_move_to&quot;</span><span class="p">,</span> <span class="s2">&quot;[0, 0, 0]&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_move_to&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_move_to&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_move_to&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_relative_move_to&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_axis&quot;</span><span class="p">,</span> <span class="s2">&quot;1 1 1 2 1 3&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_axis&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;1 1&quot;</span><span class="p">,</span> <span class="s2">&quot;1 2&quot;</span><span class="p">,</span> <span class="s2">&quot;1 3&quot;</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_axis&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;1 1&quot;</span><span class="p">,</span> <span class="s2">&quot;1 2&quot;</span><span class="p">,</span> <span class="s2">&quot;1 3&quot;</span><span class="p">))))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_axis&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;1 1&quot;</span><span class="p">,</span> <span class="s2">&quot;1 2&quot;</span><span class="p">))))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_polepairs&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;50 1&quot;</span><span class="p">,</span> <span class="s2">&quot;50 2&quot;</span><span class="p">,</span> <span class="s2">&quot;50 3&quot;</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;get_position&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_table</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;calibrate_motor&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>


    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_237</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_complience&quot;</span><span class="p">,</span> <span class="s2">&quot;100e-6, 100e-5&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_237</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_complience&quot;</span><span class="p">,</span> <span class="s2">&quot;(100e-6, 100e-5)&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_237</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_complience&quot;</span><span class="p">,</span> <span class="s2">&quot;[100e-6, 100e-5]&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_237</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_complience&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_237</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_voltage&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span><span class="p">])))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_237</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_complience&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span><span class="p">])))</span>

    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_dict</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_complience&quot;</span><span class="p">,</span> <span class="s2">&quot;100e-6&quot;</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">build_command</span><span class="p">(</span><span class="n">device_dict</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;set_complience&quot;</span><span class="p">)))</span>



    <span class="c1">#trans = transformation()</span>
    <span class="c1"># Just for testing the transformation</span>
    <span class="c1">#a1 = [350, 250, 12]</span>
    <span class="c1">#a2 = [600, 250, 15]</span>
    <span class="c1">#a3 = [350, 400, 12]</span>

    <span class="c1">#b1 = [0, 0, 0]</span>
    <span class="c1">#b2 = [250, 0, 0]</span>
    <span class="c1">#b3 = [0, 150, 0]</span>

    <span class="c1">#T, V0 = trans.transformation_matrix(b1,b2,b3,a1,a2,a3)</span>
    <span class="c1">#print (T)</span>
    <span class="c1">#print (V0)</span>
    <span class="c1">#print (trans.vector_trans([12,23, 0], T,V0))</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Dominic Bloech.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'beta',
            LANGUAGE:'Python 2.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>